_ = require 'lodash'
_.mixin require 'lodash-deep'

#constants
LOCAL_APP_ENVIRONMENT = 'development'

#cached config variable
config = null

setup = (defaultConfig, environmentConfig) ->
    config = _.merge {}, defaultConfig, environmentConfig

getAllConfig = ->
    throw new Error 'Need to call setup on mi9-enviromnent' unless config
    return _.cloneDeep config

get = (key) ->
    throw new Error 'Need to call setup on mi9-enviromnent' unless config
    return _.deepGet config, key

getAppEnvironment = -> process.env.APP_ENV ? LOCAL_APP_ENVIRONMENT

module.exports = {setup, getAllConfig, get, getAppEnvironment}
